<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.0/font/bootstrap-icons.css" rel="stylesheet">
    <title>Accessing API</title>
    <style>
        body {
            padding-left: 10px;
            padding-right: 10px;
            box-sizing: border-box;
            overflow-x: hidden;
            background-color: black;
        }

        .row {
            min-height: 550px;
            /* Changed height to min-height for better responsiveness */
        }
    </style>
    <script>
        function bodyLoad() {
            // Fetch categories
            fetch('https://fakestoreapi.com/products/categories')
                .then(function (response) {
                    return response.json();
                })
                .then(function (categories) {
                    var select = document.getElementById("categoryOption");
                    categories.forEach(function (category) {
                        var option = document.createElement("option");
                        option.text = category.toUpperCase();
                        option.value = category;
                        select.appendChild(option);
                    });
                })
                .catch(function (error) {
                    console.error('Error fetching categories:', error);
                });

            // Function to fetch products based on selected category
            document.getElementById("categoryOption").addEventListener("change", function () {
                var selectedCategory = this.value;
                fetch(`https://fakestoreapi.com/products/category/${selectedCategory}`)
                    .then(function (response) {
                        return response.json();
                    })
                    .then(function (products) {
                        displayProducts(products);
                    })
                    .catch(function (error) {
                        console.error(`Error fetching products for category ${selectedCategory}:`, error);
                    });
            });

            // Initial fetch to populate products
            fetch('https://fakestoreapi.com/products')
                .then(function (response) {
                    return response.json();
                })
                .then(function (products) {
                    displayProducts(products);
                })
                .catch(function (error) {
                    console.error('Error fetching products:', error);
                });
        }

        // Function to display products in the UI
        function displayProducts(products) {
            var content = document.getElementById("content");
            content.innerHTML = ""; // Clear previous content
            products.forEach(function (product) {
                var div = document.createElement("div");
                div.className = "card m-2 p-2";
                div.style.width = "250px";
                div.innerHTML = `
                    <img src="${product.image}" class="card-img-top" height="140">
                    <div class="card-header" style="height:100px overflow:hidden">
                        <p>${product.title}</p>
                    </div>
                    <div class="card-body">
                        <dl>
                            <dt>Price</dt>
                            <dd>$ ${product.price}</dd>
                            <dt>Rating</dt>
                            <dd>${product.rating.rate}</dd>
                        </dl>
                    </div>
                    <div class="card-footer">
                        <button onclick="addCart(${product.id})" class="btn btn-warning w-100 bi bi-cart"> Add to cart </button>
                    </div>
                `;
                content.appendChild(div);
            });
        }

        // Placeholder function for adding to cart
        function addCart(productId) {
            // Implement cart functionality as needed
            console.log('Added to cart:', productId);
        }
    </script>
</head>

<body onload="bodyLoad()">
    <div class="header-wrapper border border-1 bg-success my-2">
        <h4>This is Header</h4>
    </div>
    <div class="row ms-1 my-2 d-flex justify-content-center">
        <div class="col-3 me-3 border border-1 bg-warning">
            <h4>Accessing API from FakeStore</h4>
            <select id="categoryOption" class="form-select w-75 ms-4"></select>
        </div>
        <div class="col-8 border border-1 ps-1 bg-danger">
            <main id="content" class="d-flex flex-wrap overflow-auto justify-content-between" style="height: 500px;"></main>
        </div>
    </div>

    <!-- Optional: Bootstrap JS (if needed for dropdown functionality or other components) -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script> -->
</body>

</html>